{"version":3,"sources":["../../src/business/usersmanage.js"],"names":[],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;;;;IAEqB,W;AACnB,yBAAc;AAAA;AAEb;;;;;;;;;;;;wBAQG,G,EAAI,G,EAAI,I,EAAM;AAChB,UAAI,OAAO,IAAI,IAAJ,GAAW,IAAI,IAAJ,CAAS,IAApB,GAA2B,EAAtC;AACA,UAAI,MAAM,IAAI,IAAJ,GAAW,IAAI,IAAJ,CAAS,GAApB,GAA0B,EAApC;AACA,UAAI,OAAO,mBAAS,EAAE,QAAQ,IAAV,EAAgB,OAAO,GAAvB,EAAT,CAAX;AACA,WAAK,IAAL,CAAU,UAAC,GAAD,EAAS;AACjB,YAAI,GAAJ,EAAS;AACP,cAAI,IAAJ,CAAS,EAAE,WAAW,KAAb,EAAoB,SAAS,MAA7B,EAAT;AACD,SAFD,MAEO;AACL,cAAI,IAAJ,CAAS,EAAE,WAAW,IAAb,EAAmB,SAAS,MAA5B,EAAT;AACD;AACF,OAND;AAOD;;;;;;;;;;wBAOG,G,EAAK,G,EAAK,I,EAAM;AAClB,UAAI,OAAO,IAAI,IAAJ,GAAW,IAAI,IAAJ,CAAS,IAApB,GAA2B,EAAtC;AACA,qBAAK,MAAL,CAAY,EAAE,QAAQ,IAAV,EAAZ,EAA8B,UAAC,GAAD,EAAS;AACrC,YAAI,GAAJ,EAAS;AACP,cAAI,IAAJ,CAAS,EAAE,WAAW,KAAb,EAAoB,SAAS,MAA7B,EAAT;AACD,SAFD,MAEO;AACL,cAAI,IAAJ,CAAS,EAAE,WAAW,IAAb,EAAmB,SAAS,MAA5B,EAAT;AACD;AACF,OAND;AAOD;;;2BAEM,G,EAAK,G,EAAK,I,EAAM;AACrB,UAAI,OAAO,IAAI,IAAJ,GAAW,IAAI,IAAJ,CAAS,IAApB,GAA2B,EAAtC;AACA,UAAI,MAAM,IAAI,IAAJ,GAAW,IAAI,IAAJ,CAAS,GAApB,GAA0B,EAApC;AACA,qBAAK,OAAL,CAAa,EAAE,QAAQ,IAAV,EAAb,EAA+B,UAAC,GAAD,EAAM,IAAN,EAAe;AAC5C,YAAI,GAAJ,EAAS;AACP,cAAI,IAAJ,CAAS,EAAE,WAAW,KAAb,EAAoB,SAAS,SAA7B,EAAT;AACD;AACD,YAAI,IAAJ,EAAU;AACR,eAAK,GAAL,GAAW,GAAX;AACA,eAAK,IAAL,CAAU,UAAC,GAAD,EAAS;AACjB,gBAAI,GAAJ,EAAS;AACP,kBAAI,IAAJ,CAAS,EAAE,WAAW,KAAb,EAAoB,SAAS,MAA7B,EAAT;AACD,aAFD,MAEO;AACL,kBAAI,IAAJ,CAAS,EAAE,WAAW,IAAb,EAAmB,SAAS,MAA5B,EAAT;AACD;AACF,WAND;AAOD;AACF,OAdD;AAeD;;;yBAEI,G,EAAI,G,EAAI,I,EAAM;AACjB,qBAAK,IAAL,CAAU,EAAV,EAAa,UAAb,EAAwB,UAAC,GAAD,EAAK,QAAL,EAAkB;AACxC,YAAI,IAAJ,CAAS,EAAC,WAAU,IAAX,EAAgB,UAAS,QAAzB,EAAT;AACD,OAFD;AAGD;;;4BAEO,G,EAAI,G,EAAI,I,EAAM;AACpB,UAAI,OAAO,IAAI,MAAJ,GAAa,IAAI,MAAJ,CAAW,IAAxB,GAA+B,EAA1C;AACA,qBAAK,OAAL,CAAa,EAAC,MAAK,IAAN,EAAb,EAAyB,UAAzB,EAAoC,UAAC,GAAD,EAAK,IAAL,EAAc;AAChD,YAAI,GAAJ,EAAS;AACP,cAAI,IAAJ,CAAS,EAAC,WAAU,KAAX,EAAiB,SAAQ,QAAzB,EAAT;AACD;AACD,YAAI,IAAJ,EAAU;AACR,cAAI,IAAJ,CAAS,IAAT;AACD,SAFD,MAEO;AACL,cAAI,IAAJ,CAAS,EAAC,WAAU,KAAX,EAAiB,SAAQ,QAAzB,EAAT;AACD;AACF,OATD;AAUD;;;;;;kBA9EkB,W;AA+EpB","file":"usersmanage.js","sourcesContent":["import User from '../models/user';\r\nimport mongoose from 'mongoose';\r\n// 用户业务类\r\nexport default class UsersManage {\r\n  constructor() {\r\n\r\n  }\r\n\r\n  /**\r\n   * 添加一个用户\r\n   * @param  {http请求对象} req\r\n   * @param  {HTTP响应对象} res\r\n   * @param  {中间件转发} next\r\n   */\r\n  add(req,res,next) {\r\n    let name = req.body ? req.body.name : '';\r\n    let age = req.body ? req.body.age : '';\r\n    let user = new User({ 'name': name, 'age': age });\r\n    user.save((err) => {\r\n      if (err) {\r\n        res.json({ IsSuccess: false, Message: '添加失败' });\r\n      } else {\r\n        res.json({ IsSuccess: true, Message: '添加成功' });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @param  {} req\r\n   * @param  {} res\r\n   * @param  {} next\r\n   */\r\n  del(req, res, next) {\r\n    let name = req.body ? req.body.name : '';\r\n    User.remove({ 'name': name }, (err) => {\r\n      if (err) {\r\n        res.json({ IsSuccess: false, Message: '删除失败' });\r\n      } else {\r\n        res.json({ IsSuccess: true, Message: '删除成功' });\r\n      }\r\n    });\r\n  }\r\n\r\n  update(req, res, next) {\r\n    let name = req.body ? req.body.name : '';\r\n    let age = req.body ? req.body.age : '';\r\n    User.findOne({ 'name': name }, (err, user) => {\r\n      if (err) {\r\n        res.json({ IsSuccess: false, Message: '获取用户失败。' });\r\n      }\r\n      if (user) {\r\n        user.age = age;\r\n        user.save((err) => {\r\n          if (err) {\r\n            res.json({ IsSuccess: false, Message: '更新失败' });\r\n          } else {\r\n            res.json({ IsSuccess: true, Message: '更新成功' });\r\n          }\r\n        });\r\n      };\r\n    });\r\n  }\r\n\r\n  list(req,res,next) {\r\n    User.find({},'name age',(err,userList) => {\r\n      res.json({IsSuccess:true,UserList:userList})\r\n    });\r\n  }\r\n\r\n  findOne(req,res,next) {\r\n    let name = req.params ? req.params.name : '';\r\n    User.findOne({name:name},'name age',(err,user) => {\r\n      if (err) {\r\n        res.json({IsSuccess:false,Message:'获取详情失败'});\r\n      }\r\n      if (user) {\r\n        res.json(user);\r\n      } else {\r\n        res.json({IsSuccess:false,Message:'获取详情失败'});\r\n      }\r\n    })\r\n  }\r\n};\r\n"]}